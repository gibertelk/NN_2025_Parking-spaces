# NN_2025_Parking-spaces

## Задача
В данном проекте решается задача определения количества мест на парковке по фотографиям. Другими словами, перед нами стояла задача детекции мест и определении класса детектированного объекта (занято место или свободно).

## Часть 1. Датасет и подготовка данных
Для работы использовался публичный датасет https://www.kaggle.com/datasets/ammarnassanalhajali/pklot-dataset/data?select=README.roboflow.txt, содержащий 12416 изображений парковок, сделанных с камер наблюдения, и около 695900 аннотированных парковочных мест. Для уменьшения вычислительных затрат была произведена стратификация через эмбединги, чтобы отобрать из всего датасета только часть данных, разнообразных и насколько возможно охватывающих весь датасет. Затем, опять с помощью стратификации через эмбединги, полученные данные были разделены на датасеты для обучения(1508 изображений), валидации(168 изображений) и теста(397 изображений). 

## Часть 2. Выбор модели
Всего было рассмотрено 3 модели:  
1. Кастомный YOLO с сеткой 20х20
2. Кастомный YOLO с сеткой 13х13
3. Faster R-CNN с ResNet-18 backbone

Данные модели были рассмотрены, так как они является легковесными, что важно из-за ограниченности ресурсов комнады.

Итоговая модель выбиралась по mAP и valid_loss.
 В файле model_yolo.ipynb представлен Кастомный код YOLO, обученный на 20 эпохах.
 В файле model_faster_r-cnn.ipynb представлен код для Faster R-CN, обученный на 20 эпохах.

Результаты обучения модели 1:
![IMAGE 2025-12-19 23:32:25](https://github.com/user-attachments/assets/3e4951e9-f2a9-41b7-9e2e-eea649266fe5)

Результаты обучения модели 2:
![IMAGE 2025-12-19 23:32:18](https://github.com/user-attachments/assets/112b7adb-3c40-4091-a164-9f7a60cbeb4c)

Результаты обучения модели 3:
![IMAGE 2025-12-19 23:31:50](https://github.com/user-attachments/assets/a1873679-02db-4a91-a71b-457d194fcff6)

В качестве итоговой модели была выбрана кастомная Yolo с backbon ResNet18 с сеткой 13х13.
<img width="452" height="101" alt="Снимок экрана 2025-12-19 в 23 39 50" src="https://github.com/user-attachments/assets/3872e2e8-7d0c-47c6-abb8-9c46311c18c7" />

## Часть 3. Обучение модели и результаты
Обучение итоговой модели происходило на 30 эпохах с batch_size=2.

## Часть 4. Апишечка
